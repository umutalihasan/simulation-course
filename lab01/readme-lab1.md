


# Atmospheric Flight Simulator 

**Отчет по работе: Моделирование полета тела в атмосфере**






**Интерактивный симулятор:** [umut.ipmkn.ru](http://umut.ipmkn.ru)

Веб-приложение для детального физического моделирования траектории полета твердого тела в атмосфере Земли. Проект наглядно демонстрирует законы баллистики с учетом аэродинамического сопротивления (Drag), динамического изменения плотности воздуха в зависимости от высоты (по модели ISA) и влияния ветровой нагрузки.

---

## 1. Описание проекта

Проект служит эффективным инструментом для изучения численных методов интегрирования дифференциальных уравнений (в частности, метода Эйлера) и основ аэродинамики. Симулятор позволяет в реальном времени визуализировать траектории и проводить сравнительный анализ при изменении следующих параметров:

* **Шаг интегрирования (dt):** от 1 до 0.0001 секунды для оценки вычислительной сходимости.
* **Форма и свойства объекта:** Сфера (Cd = 0.47), Пуля (Cd = 0.04), Куб (Cd = 1.05), Капля и пользовательские значения.
* **Окружающая среда:** Вакуум, среда с постоянной плотностью или реалистичная модель атмосферы (ISA).
* **Вектор ветра:** Настройка скорости и угла направления ветра для оценки бокового и встречного/попутного сноса.

---

## 2. Теоретическая и математическая модель

В основе симуляции лежит численное решение системы обыкновенных дифференциальных уравнений (ОДУ).

**Аэродинамическое сопротивление:**
Сила лобового сопротивления вычисляется по формуле:
`Fd = 0.5 * Cd * rho * A * v^2`

**Дифференциальные уравнения движения:**
Ускорение тела формируется из гравитационной составляющей и проекций силы сопротивления на оси координат:
`ax = - Fdx / m`
`ay = - g - (Fdy / m)`

---

## 3. Архитектура и ключевые алгоритмы

Исходный код симулятора разделен на логические блоки. Ниже представлены ключевые алгоритмические решения (из файла `source.js`), обеспечивающие физическую достоверность симуляции и высокую производительность в браузере.

### 3.1. Динамическая модель атмосферы (ISA)

Плотность воздуха `rho` не является константой. Функция `getAirDensity` рассчитывает плотность в зависимости от текущей высоты объекта. Реализована модель тропосферы (до 11 км) и аппроксимация стратосферы.

```javascript
function getAirDensity(altMeters, model) {
  if (model === 'const') return 1.225; // Уровень моря
  if (model === 'const129') return 1.29;
  
  if (altMeters < 0) altMeters = 0;
  
  // Тропосфера (0–11000m)
  if (altMeters <= 11000) {
    const T = 288.15 - 0.0065 * altMeters; // Падение температуры с высотой
    return 1.225 * Math.pow(T / 288.15, 4.2561); // Барометрическая формула
  } else {
    // Стратосфера (аппроксимация экспоненциальным убыванием)
    return 0.3639 * Math.exp(-0.0001576 * (altMeters - 11000));
  }
}

```

### 3.2. Главный цикл физического движка (Метод Эйлера)

Функция `runPhysics` является ядром симулятора. Она использует явный метод Эйлера первого порядка. Важной особенностью алгоритма является расчет **относительной скорости набегающего потока** (`vrx`, `vry`) с учетом горизонтального вектора ветра (`windX`).

```javascript
while (y >= 0 && steps < maxSteps) {
  const rho = getAirDensity(y, atmoModel);
  // k - объединенный аэродинамический коэффициент
  const k = 0.5 * cd * rho * area / mass;

  // Векторная разность скоростей (Скорость тела минус скорость ветра)
  const vrx = vx - windX;
  const vry = vy;
  const vr = Math.sqrt(vrx * vrx + vry * vry);

  let ax = 0, ay = -G;
  
  // Добавление аэродинамического ускорения
  if (vr > 0) {
    ax -= k * vrx * vr;
    ay -= k * vry * vr;
  }

  // Численное интегрирование (Метод Эйлера)
  vx += ax * dt;
  vy += ay * dt;
  x  += vx * dt;
  y  += vy * dt;
  
  // Обновление максимальной высоты
  if (y > maxH) maxH = y;
  
  // ... (Проверки столкновений и запись точек)
  steps++;
}

```

### 3.3. Алгоритм точного обнаружения столкновения с землей

Поскольку шаг времени `dt` дискретен, на последнем шаге тело может "провалиться" под землю (`y < 0`). Для предотвращения погрешности в измерении итоговой дальности применяется математическая **линейная интерполяция** между последней точкой над землей и точкой под землей:

```javascript
// Коррекция дальности при пробитии нулевой отметки (земли)
if (y < 0) {
  const prev = pts[pts.length - 1]; // Берем предыдущую сохраненную координату
  
  // Вычисляем дробную часть пути до y=0
  const frac = prev.y / (prev.y - y); 
  
  // Корректируем итоговую дальность (x) пропорционально
  x = prev.x + frac * (x - prev.x); 
  y = 0; // Строгая фиксация на уровне земли
}

```

### 3.4. Оптимизация памяти и рендеринга (Downsampling)

При малых шагах (например, `dt = 0.0001`) цикл генерирует миллионы точек массива координат. Отрисовка каждой отдельной точки на Canvas вызвала бы критическое зависание страницы браузера. Внедрен алгоритм даунсэмплинга (прореживания массива), который динамически уменьшает количество сохраняемых точек:

```javascript
// Downsample for performance: сохраняем каждую N-ную точку
if (steps < 50000 || steps % Math.max(1, Math.floor(steps / 5000)) === 0) {
  pts.push({x, y});
}

```

---

## 4. Сравнительный анализ: Влияние шага интегрирования

Оценка накопления локальной ошибки метода Эйлера.
**Базовые условия:** Высота: 100 м, Скорость: 100 м/с, Угол: 45°, Масса: 1 кг, Сечение: 0.01 м², Ветер: 0 м/с.

### Таблица 1. Сравнение "Сфера" (Cd = 0.47) и "Пуля" (Cd = 0.04)

| Форма | Шаг dt, с | Дальность, м | Макс. Высота, м | Кон. Скорость, м/с |
| --- | --- | --- | --- | --- |
| **Сфера** | 1 | 295.805 | 174.619 | 58.375 |
| **Сфера** | 0.1 | 389.617 | 226.500 | 58.375 |
| **Сфера** | 0.01 | 398.492 | 231.584 | 58.375 |
| **Сфера** | 0.001 | 399.375 | 232.092 | 58.375 |
| **Сфера** | 0.0001 | 399.463 | 232.143 | 58.375 |
| --- | --- | --- | --- | --- |
| **Пуля** | 1 | 865.034 | 294.448 | 200.102 |
| **Пуля** | 0.1 | 930.838 | 328.050 | 200.102 |
| **Пуля** | 0.01 | 937.423 | 331.516 | 200.102 |
| **Пуля** | 0.001 | 938.081 | 331.864 | 200.102 |
| **Пуля** | 0.0001 | 938.147 | 331.899 | 200.102 |

**Академические выводы:** При грубом шаге (dt = 1) ускорение считается неизменным в течение секунды, что приводит к гигантской вычислительной ошибке (~73 метра потери дальности для пули). Асимптотическая сходимость достигается при dt <= 0.001. Объект обтекаемой формы ("Пуля") пролетает в 2.35 раза дальше за счет минимизации энергетических потерь. Конечная скорость (терминальная скорость падения) от шага не зависит.

---

## 5. Сравнительный анализ: Векторная ветровая нагрузка

Исследование влияния вектора ветра на объект "Пуля" (Cd = 0.04).
**Условия ветра:** 14 м/с под углом 23° (Попутно-боковой).

### Таблица 2. Влияние ветра на траекторию Пули

| Шаг dt, с | Дальность (Штиль), м | Дальность (Ветер), м | Макс. Высота (Штиль), м | Макс. Высота (Ветер), м |
| --- | --- | --- | --- | --- |
| **1** | 865.034 | 904.365 | 294.448 | 296.767 |
| **0.1** | 930.838 | 971.286 | 328.050 | 330.313 |
| **0.01** | 937.423 | 977.953 | 331.516 | 333.764 |
| **0.001** | 938.081 | 978.620 | 331.864 | 334.110 |
| **0.0001** | 938.146 | 978.686 | 331.898 | 334.145 |

**Академические выводы:** Наличие попутного ветра снижает относительную скорость набегающего потока (V_rx). Так как сопротивление пропорционально квадрату относительной скорости (v^2), это резко снижает аэродинамическое торможение. В результате дальность полета при точном шаге интегрирования увеличилась на **40.54 метра**, а вертикальный снос слегка увеличил максимальную высоту.

---
## 6. Screenshots

Ниже представлены демонстрационные экраны работы симулятора:

**Полный интерфейс симулятора (Сфера vs Пуля):**
![Полный интерфейс симулятора](Ekran%20görüntüsü%202026-02-20%20002352.png)

**Сравнение траекторий полета:**
![Сравнение траекторий](Ekran%20görüntüsü%202026-02-20%20002328.png)

**Таблица результатов и симуляционный лог:**
![Таблица результатов и лог](Ekran%20görüntüsü%202026-02-20%20002339.png)

**Режим пользовательских настроек (Custom):**
![Режим пользовательских настроек](Ekran%20görüntüsü%202026-02-19%20225825.png)

---
## 7. Установка и запуск

Проект написан на Vanilla HTML/CSS/JS (без использования тяжелых фреймворков и сторонних библиотек физики), вычисления производятся исключительно на стороне клиента (вашего браузера).

1. Откройте файл `index.html` в любом современном веб-браузере.
2. Настройте параметры на панели слева и нажмите **RUN SIMULATION**.
3. Или посетите рабочую онлайн-версию: **[umut.ipmkn.ru](http://umut.ipmkn.ru)**



